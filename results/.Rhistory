library(igraph)
setwd("C:/R_data/pnas_16")
steps = 10  					#number of simulation steps
pp = 0.15  					#propagation probability
percentage = 0.25				#number of seeds
network = 16					#network id
graph1 <- read.graph(paste(network,".txt",sep=""), format="edgelist")
nodes = vcount(graph1)
numberofseeds = round(nodes * percentage, digits = 0)
Sys.time()
infections = 0
for( i in 1:nodes )
{
V(graph1)[i]$infected = 0
V(graph1)[i]$used = 0
}
x=sample(nodes,numberofseeds)			#select random seeds
for( seeds in 1:numberofseeds ) 		#seeding process
{
V(graph1)[x[seeds]]$infected = 1
V(graph1)[x[seeds]]$stepinfected = 0
V(graph1)[x[seeds]]$used = 0
V(graph1)[x[seeds]]$color = "green"
plot(graph1, layout=layout.kamada.kawai,vertex.size=10)
}
for( s in 1:steps )
{
for( j in 1:nodes )
{
if( V(graph1)[j]$infected == 1 & V(graph1)[j]$used == 0 & V(graph1)[j]$stepinfected != s )
{
V(graph1)[j]$used = 1
neighborstab = neighbors(graph1, j, mode = c("all"))
if ( length(neighborstab) > 0 )
{
notinfected = array()
n = 0
for( i in 1:length(neighborstab) )
{
if ( V(graph1)[neighborstab[i]]$infected == 0 )
{
n = n + 1
notinfected[n] = neighborstab[i]
}
}
numberofneighbors <- length(notinfected)
if ( !is.na(notinfected[1]) )
{
for( k in 1:numberofneighbors )
{
if ( numberofneighbors >= 1 )
{
x <- runif(1)
if ( x <= pp )
{
V(graph1)[notinfected[k]]$color = "red"
V(graph1)[notinfected[k]]$infected = 1
V(graph1)[notinfected[k]]$used = 0
V(graph1)[notinfected[k]]$stepinfected = s
infections = infections + 1
plot(graph1, layout=layout.kamada.kawai,vertex.size=10)
}
}
}
}
}
}
}
print(infections)
}
print("Total coverage % (infections + seeds):")
print(100*(numberofseeds + infections)/nodes)
greedyData = read.csv('greedy-OP/results/greedyToDisplay.csv', header=FALSE,sep=",")
setwd("/Users/apple/Desktop/SNA_links/results")
greedyData = read.csv('greedy-OP/results/greedyToDisplay.csv', header=FALSE,sep=",")
greedyData = read.csv('/greedy-OP/results/greedyToDisplay.csv', header=FALSE,sep=",")
greedyData = read.csv('greedy-OP/results/greedyToDisplay.csv', header=FALSE,sep=",")
setwd("/Users/apple/Desktop/SNA_links")
maxData = read.csv('readytoDisplayMax.csv', header=FALSE,sep=",")
maxData = read.csv('readytoDisplayMax.csv', header=FALSE,sep=",")
greedyData = read.csv('greedy-OP/results/greedyToDisplay.csv', header=FALSE,sep=",")
greedyData = read.csv('greedy-OP/results/greedyToDisplay.csv', header=TRUE,sep=",")
greedyData = read.csv('greedy-OP/results/greedyToDisplay.csv', header=TRUE,sep=",")
maxData = read.csv('greedy-OP/results/listOfNetworksWithMaxCoverage', header=TRUE,sep=",")
maxData = read.csv('greedy-OP/results/listOfNetworksWithMaxCoverage.csv', header=TRUE,sep=",")
View(maxData)
View(maxData)
View(greedyData)
View(greedyData)
png(paste("points.png"),width = 3000, height = 3000, res=300)
par(mfrow=c(2,2))
plot(maxData$closeness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='closeness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$closeness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$closeness,greedyData$coverage,col="green2",  pch=20,  cex=1, bg="red")
points(maxData$closeness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
legend("topleft", c("max","all","greedy"), col=colors, cex=2, lty=c(1,1), lwd=c(2,2), bty="n");
plot(maxData$transitivity,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='transitivity',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$transitivity,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$transitivity,greedyData$coverage,col="green2",  pch=20,  cex=1, bg="red")
points(maxData$transitivity,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
plot(maxData$eigenvector,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='eigenvector',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$eigenvector,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$eigenvector,greedyData$coverage,col="green2",  pch=20,  cex=1, bg="red")
points(maxData$eigenvector,maxData$coverage,col="red",  pch=20, cex=1, bg="red")
plot(maxData$betweenness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='betweenness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$betweenness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$betweenness,greedyData$coverage,col="green2",  pch=20,  cex=1, bg="red")
points(maxData$betweenness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
View(maxData)
View(maxData)
plot(maxData$closeness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='closeness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$closeness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$closeness,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$closeness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
legend("topleft", c("max","all","greedy"), col=colors, cex=2, lty=c(1,1), lwd=c(2,2), bty="n");
plot(maxData$transitivity,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='transitivity',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$transitivity,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$transitivity,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$transitivity,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
plot(maxData$eigenvector,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='eigenvector',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$eigenvector,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$eigenvector,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$eigenvector,maxData$coverage,col="red",  pch=20, cex=1, bg="red")
plot(maxData$betweenness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='betweenness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$betweenness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$betweenness,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$betweenness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
png(paste("points.png"),width = 3000, height = 3000, res=300)
par(mfrow=c(2,2))
plot(maxData$closeness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='closeness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$closeness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$closeness,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$closeness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
legend("topleft", c("max","all","greedy"), col=colors, cex=2, lty=c(1,1), lwd=c(2,2), bty="n");
plot(maxData$transitivity,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='transitivity',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$transitivity,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$transitivity,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$transitivity,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
plot(maxData$eigenvector,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='eigenvector',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$eigenvector,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$eigenvector,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$eigenvector,maxData$coverage,col="red",  pch=20, cex=1, bg="red")
plot(maxData$betweenness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='betweenness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$betweenness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$betweenness,greedyData$coverage,col="green2",  pch=20,  cex=3, bg="red")
points(maxData$betweenness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
png(paste("points.png"),width = 3000, height = 3000, res=300)
par(mfrow=c(2,2))
plot(maxData$closeness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='closeness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$closeness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$closeness,greedyData$coverage,col="green2",  pch=20,  cex=2, bg="red")
points(maxData$closeness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
legend("topleft", c("max","all","greedy"), col=colors, cex=2, lty=c(1,1), lwd=c(2,2), bty="n");
plot(maxData$transitivity,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='transitivity',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$transitivity,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$transitivity,greedyData$coverage,col="green2",  pch=20,  cex=2, bg="red")
points(maxData$transitivity,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
plot(maxData$eigenvector,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='eigenvector',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$eigenvector,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$eigenvector,greedyData$coverage,col="green2",  pch=20,  cex=2, bg="red")
points(maxData$eigenvector,maxData$coverage,col="red",  pch=20, cex=1, bg="red")
plot(maxData$betweenness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='betweenness',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
#points(data$betweenness,data$coverage,col="black",  pch=20,  cex=1, bg="red")
points(greedyData$betweenness,greedyData$coverage,col="green2",  pch=20,  cex=2, bg="red")
points(maxData$betweenness,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
data = read.csv('greedy-OP/results/greedyToDisplay', header=FALSE,sep=",")
greedyData = read.csv('greedy-OP/results/greedyToDisplay.csv', header=TRUE,sep=",")
maxData = read.csv('greedy-OP/results/listOfNetworksWithMaxCoverage.csv', header=TRUE,sep=",")
png(paste("points.png"),width = 3000, height = 3000, res=300)
plot(maxData$closeness,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
plot(maxData$links,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
colors <- c("red","black","green2")
title(xlab='links',mgp=c(2.5,1,0), cex.lab=2.5)
title(ylab='coverage',mgp=c(2.5,1,0), cex.lab=2.5)
points(greedyData$links,greedyData$coverage,col="green2",  pch=20,  cex=2, bg="red")
points(maxData$links,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
data = read.csv('greedy-OP/results/greedyToDisplayAll', header=FALSE,sep=",")
data = read.csv('greedy-OP/results/greedyToDisplayAll.csv', header=FALSE,sep=",")
View(data)
View(data)
data = read.csv('greedy-OP/results/greedyToDisplayAll.csv', header=TRUE,sep=",")
png(paste("points.png"),width = 3000, height = 3000, res=300)
plot(data$number,maxData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
plot(data$number,data$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(data$number,data$closeness,col="black",  pch=20,  cex=1, bg="red")
points(data$number,data$transitivity,col="black",  pch=20,  cex=1, bg="red")
points(data$number,data$eigenvector,col="black",  pch=20,  cex=1, bg="red")
points(data$number,data$betweenness,col="black",  pch=20,  cex=1, bg="red")
dev.off()
png(paste("points.png"),width = 3000, height = 3000, res=300)
par(mfrow=c(2,2))
plot(data$number,data$closeness,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(data$number,data$closeness,col="black",  pch=20,  cex=1, bg="red")
plot(data$number,data$transitivity,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(data$number,data$transitivity,col="black",  pch=20,  cex=1, bg="red")
plot(data$number,data$eigenvector,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(data$number,data$eigenvector,col="black",  pch=20,  cex=1, bg="red")
plot(data$number,data$betweenness,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(data$number,data$betweenness,col="black",  pch=20,  cex=1, bg="red")
dev.off()
orderData = [order(data),]
orderData = data[order(coverage),]
View(data)
View(data)
orderData = data[order(data$coverage),]
View(orderData)
View(orderData)
data = read.csv('resultWithE.csv', header=FALSE,sep=",")
setwd("/Users/apple/Desktop/SNA_links/results")
data = read.csv('resultWithE.csv', header=FALSE,sep=",")
orederData = data[order(data$coverage),]
View(data)
View(data)
colnames(data)[1] = 'net'
colnames(data)[2] = 'coverage'
colnames(data)[3] = 'nodes'
colnames(data)[4] = 'links'
colnames(data)[5] = 'closeness'
colnames(data)[6] = 'transitivity'
colnames(data)[7] = 'eigenvector'
colnames(data)[8] = 'betweenness'
orederData = data[order(data$coverage),]
orderData = data[order(data$coverage),]
View(orderData)
View(orderData)
View(orederData)
View(orederData)
View(orederData$V0)
nrow(orderData)
points(1:nrow(orderData),orderData$coverage,col="red",  pch=20,  cex=1, bg="red")
View(maxData)
View(maxData)
png(paste("points.png"),width = 3000, height = 3000, res=300)
plot(orderData$net,orderData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(orderData$net,orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
points(maxData$net,maxData$coverage,col="black",  pch=20,  cex=1, bg="red")
dev.off()
png(paste("points.png"),width = 3000, height = 3000, res=300)
plot(orderData$net,orderData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(orderData$net,orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
points(maxData$net,maxData$coverage,col="black",  pch=20,  cex=1, bg="red")
dev.off()
png(paste("points.png"),width = 3000, height = 3000, res=300)
plot(orderData$net,orderData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(orderData$net,orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
points(maxData$net,maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
png(paste("points.png"),width = 3000, height = 3000, res=300)
plot(1:nrow(orderData),orderData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(1:nrow(orderData),orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
points(1:nrow(orderData),maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
plot(1:nrow(orderData),orderData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(1:nrow(orderData),orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
points(1:nrow(maxData),maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
dev.off()
points(1:nrow(orderData),orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
plot(1:nrow(orderData),orderData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(1:nrow(orderData),orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
points(1:nrow(maxData),maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
plot(orderData$coverage,1:nrow(orderData),col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(orderData$coverage,1:nrow(orderData)col="black",  pch=20,  cex=1, bg="red")
points(maxData$coverage,1:nrow(maxData),col="red",  pch=20,  cex=1, bg="red")
points(orderData$coverage,1:nrow(orderData),col="black",  pch=20,  cex=1, bg="red")
plot(1:nrow(orderData),orderData$coverage,col="white",xlab="",  ylab="", cex.lab=2.5,mgp = c(2.5, 1, 0), cex.axis=2,log="xy" )
points(1:nrow(orderData),orderData$coverage,col="black",  pch=20,  cex=1, bg="red")
points(1:nrow(maxData),maxData$coverage,col="red",  pch=20,  cex=1, bg="red")
View(maxData)
View(maxData)
test = table1[maxData$net %in% orderData$net, ]
test = orderData[maxData$net %in% orderData$net, ]
View(test)
View(test)
