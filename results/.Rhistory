library(igraph)
setwd("C:/R_data/pnas_16")
steps = 10  					#number of simulation steps
pp = 0.15  					#propagation probability
percentage = 0.25				#number of seeds
network = 16					#network id
graph1 <- read.graph(paste(network,".txt",sep=""), format="edgelist")
nodes = vcount(graph1)
numberofseeds = round(nodes * percentage, digits = 0)
Sys.time()
infections = 0
for( i in 1:nodes )
{
V(graph1)[i]$infected = 0
V(graph1)[i]$used = 0
}
x=sample(nodes,numberofseeds)			#select random seeds
for( seeds in 1:numberofseeds ) 		#seeding process
{
V(graph1)[x[seeds]]$infected = 1
V(graph1)[x[seeds]]$stepinfected = 0
V(graph1)[x[seeds]]$used = 0
V(graph1)[x[seeds]]$color = "green"
plot(graph1, layout=layout.kamada.kawai,vertex.size=10)
}
for( s in 1:steps )
{
for( j in 1:nodes )
{
if( V(graph1)[j]$infected == 1 & V(graph1)[j]$used == 0 & V(graph1)[j]$stepinfected != s )
{
V(graph1)[j]$used = 1
neighborstab = neighbors(graph1, j, mode = c("all"))
if ( length(neighborstab) > 0 )
{
notinfected = array()
n = 0
for( i in 1:length(neighborstab) )
{
if ( V(graph1)[neighborstab[i]]$infected == 0 )
{
n = n + 1
notinfected[n] = neighborstab[i]
}
}
numberofneighbors <- length(notinfected)
if ( !is.na(notinfected[1]) )
{
for( k in 1:numberofneighbors )
{
if ( numberofneighbors >= 1 )
{
x <- runif(1)
if ( x <= pp )
{
V(graph1)[notinfected[k]]$color = "red"
V(graph1)[notinfected[k]]$infected = 1
V(graph1)[notinfected[k]]$used = 0
V(graph1)[notinfected[k]]$stepinfected = s
infections = infections + 1
plot(graph1, layout=layout.kamada.kawai,vertex.size=10)
}
}
}
}
}
}
}
print(infections)
}
print("Total coverage % (infections + seeds):")
print(100*(numberofseeds + infections)/nodes)
setwd("/Users/apple/Desktop/SNA_links/results")
data = read.csv('resultWithE.csv', header=FALSE,sep=",")
data = read.csv('result.csv', header=FALSE,sep=",")
data = read.csv('results.csv', header=FALSE,sep=",")
View(data)
View(data)
data = read.csv('results.csv', header=TRUE,sep=",")
View(data)
View(data)
unqueData <- unique(avarageInfections[, 4,2,1])
unqueData <- unique(data[, 4,2,1])
unqueData <- unique(data[, [4,2,1]])
unqueData <- unique(data[, c(1,2,4)])
View(unqueData)
View(unqueData)
unqueData <- unique(data[, c(1,2,3,4)])
View(unqueData)
View(unqueData)
unqueData <- unique(data[, c(1,2,4)])
unqueData <- data[unique(data[, c(1,2,4)]),]
test <- data[unique(data[, c(1,2,4)]),]
test <- data[,unique(data[, c(1,2,4)])]
test <- data[unique(data[, c(1,2,4)])]
unqueData <- data[unique(data[, c(1,2,4)])
dataTest <- data[,unqueData]
dataTest <- data[unqueData, ]
dataTest <- data[unqueData , ]
dataTest <- data[!unqueData, ]
unqueData <- data[!unique(data[, c(1,2,4)])
unqueData <- data[!unique(data[, c(1,2,4)])
unqueData <- data[!unique(data[, c(1,2,4)])
unqueData <- data[!unique(data[, c(1,2,4)],)
unqueData <- data[!unique(data[,])
unqueData <- unique(data[,]
unqueData <- unique(data)
m = merge(uniqueData, data)
uniqueData <- unique(data)
m = merge(uniqueData, data)
uniqueData <- unique(data, c(1,2,4))
View(uniqueData)
View(uniqueData)
uniqueData <- unique(data[,c(1,2,4)])
m = merge(uniqueData, data)
m = merge(data, uniqueData)
m = merge(data, uniqueData, by="ID")
m = merge(data, uniqueData, by=V0)
m = cbind(data, uniqueData)
data$id <- seq.int(nrow(data))
View(data)
View(data)
uniqueData <- unique(data[,c(1,2,4,5)])
uniqueData <- unique(data[,c(1,2,4)])
View(uniqueData)
View(uniqueData)
m = merge(data, uniqueData, by='row.names', all=TRUE)
m = merge(uniqueData,data , by='row.names', all=TRUE)
m = merge(uniqueData,data , by='row.names', all=TRUE)
View(m)
View(m)
uniqueData$rownames
uniqueData$row
uniqueData$row.names
new_df <- data[ order(row.names(uniqueData)), ]
View(new_df)
View(new_df)
new_df <- data[ row.names(uniqueData), ]
View(new_df)
View(new_df)
data = read.csv('results.csv', header=TRUE,sep=",")
uniqueData <- unique(data[,c(1,2,4)])
new_df <- data[ row.names(uniqueData), ]
View(new_df)
View(new_df)
new_df$meanInfections <- ave(new_df$infections, new_df$pp, FUN=mean)
new_df$meanInfections <- ave(new_df$coverage, new_df$pp, FUN=mean)
new_df$meanInfections <- ave(new_df$coverage, new_df$pp, new_df$net, FUN=mean)
new_df$meanCoverage <- ave(new_df$coverage, new_df$pp, new_df$net, FUN=mean)
dataE = read.csv('resultWithE.csv', header=FALSE,sep=",")
View(dataE)
View(dataE)
View(new_df)
View(new_df)
test <- unique(data[,c(2,4,6)])
test <- unique(new_df[,c(2,4,6)])
View(test)
View(test)
test <- unique(new_df[,c(4,6)])
View(test)
View(test)
new_df$meanCoverage <- ave(new_df$coverage, new_df$net, FUN=mean)
test <- unique(new_df[,c(4,6)])
colnames(data)[1] = 'net'
result = merge(test, dataE, by="net")
result = merge(test, dataE, by=c("net"))
colnames(dataE)[1] = 'net'
result = merge(test, dataE, by=c("net"))
View(result)
View(result)
write.csv(result, file = "resultWithE.csv")
result = subset(result, select = c('net', 'V2', 'v3'))
result = subset(result, select = c('net', 'V2', 'V3'))
result = merge(test, dataE, by=c("net"))
result = subset(result, select = c('net', 'V2', 'V3','V4', 'V5', 'V6','V7','V8'))
result = merge(test, dataE, by=c("net"))
result = subset(result, select = c('net', 'meanCoverage', 'V3','V4', 'V5', 'V6','V7','V8'))
write.csv(result, file = "resultWithE.csv")
write.csv(result, file = "resultWithE.csv",row.names=FALSE)
